syntax = "proto3";

package p2p;

import "wifs.proto";

service PeerToPeer {
    rpc Ping(HeartBeat) returns (HeartBeat) {}
    rpc p2p_GET(wifs.GetReq) returns (wifs.GetRes){}
    rpc p2p_PUT(wifs.PutReq) returns (wifs.PutRes){}
    rpc AllotServerId(HeartBeat) returns (ServerId){}
    rpc BroadcastServerId(ServerId) returns (HeartBeat){}
    rpc InitializeNewServer(HeartBeat) returns (InitMap){}
}

message HeartBeat {
    enum State {
        // can be used when doing the catch up work after failure
        INIT = 0;

        // when in normal operation
        READY = 1;
    }
    State state = 1;
}

message InitMap{
    map<int64, int32> servermap = 1;
}

message ServerId {
    int32 id = 1;
  }